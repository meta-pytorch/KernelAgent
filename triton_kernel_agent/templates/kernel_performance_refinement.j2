The current kernel implementation is functionally correct but needs performance optimization based on profiling data.

## Problem Description
{{ problem_description }}

## Current Test Code
```python
{{ test_code }}
```

## Current Kernel Implementation
```python
{{ kernel_code }}
```

## NCU Profiling Data
{% if perf_profile %}
{% for metric_name, value in perf_profile.items() %}
{{ metric_name }}: {{ "%.2f"|format(value) }}%
{% endfor %}
{% endif %}

## Task
Optimize the kernel for better performance while maintaining correctness. Return only the optimized kernel code.

```python
# Your optimized implementation here
```